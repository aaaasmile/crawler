{{define "base"}}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- <link href="./static/css/_card.scss?{{.Buildnr}}" rel="stylesheet">
    <link href="./static/css/_highcharts.scss?{{.Buildnr}}" rel="stylesheet">
    <link href="./static/css/_palette.scss?{{.Buildnr}}" rel="stylesheet">
    <link href="./static/css/_reboot.scss?{{.Buildnr}}" rel="stylesheet">
    <link href="./static/css/_root.scss?{{.Buildnr}}" rel="stylesheet">
    <link href="./static/css/_variables.scss?{{.Buildnr}}" rel="stylesheet"> -->
    <link href="./static/css/main.css?{{.Buildnr}}" rel="stylesheet">
    <link href="./static/css/mystyle.css?{{.Buildnr}}" rel="stylesheet">
    <!-- <script src="./static/lib/d3.v7.js?{{.Buildnr}}"></script> -->
    <title>SVG converter</title>
</head>

<body>
    <p id="title">Here will be changed</p>
    <div id="container"></div>
    <canvas id="mycanvas" width="400" height="200"></canvas>
    <button type="button" onclick="myfun()">Try It</button>
    <!-- <a href="" id="result"></a> -->
    <div>{{.SvgData}}</div>
</body>

<script>
    function myfun() {
        console.log('Try to make canvas')
        //var el = d3.select("svg");
        // var canvas = document.createElement("canvas");
        // canvas.width = 640;
        // canvas.height = 400;
        var canvas = document.getElementById("mycanvas")
        // var svgMarkup = '<svg xmlns="http://www.w3.org/2000/svg"'
        //     // + ' class=""'
        //     // + ' width="40"'
        //     // + ' height="14"'
        //     + '>'
        //     + '<ellipse cx="200" cy="80" rx="100" ry="50" style="fill:yellow;stroke:purple;stroke-width:2" />'
        //     + '</svg>';
        var svgMarkup = '{{.SvgData}}';
        console.log('svg markup is ', svgMarkup);
        const ctx = canvas.getContext("2d");
        const DOMURL = window.URL || window.webkitURL || window;
        const img = new Image();
        const svgCanv = new Blob([svgMarkup], { type: "image/svg+xml;charset=utf-8" });
        const url = DOMURL.createObjectURL(svgCanv);
        img.onload = function () {
            ctx.drawImage(img, 0, 0);
            console.log('Image ok');
            DOMURL.revokeObjectURL(url);
            console.log('canvas data url:', canvas.toDataURL());
            // let link = document.getElementById("result");
            // link.setAttribute("href", canvas.toDataURL());
            // link.innerHTML = "link to download";
        };
        console.log('blob url to image is ', url)
        img.src = url;
        //img.src = svgMarkup;
        //canvas.getContext("2d").drawImage(img,0,0);

        //console.log('Now change also the title...')
        //document.getElementById("title").innerHTML = '{{.SvgData}}';
    }
</script>

</html>

{{end}}